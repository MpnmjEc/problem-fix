<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Portal</title>

  <!-- Fonts & Bootstrap CSS -->
  <link href="https://fonts.googleapis.com/css2?family=PT+Sans:wght@400;700&display=swap" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
  
  <!-- SweetAlert2 CSS -->
  <link rel="stylesheet" href="loding.css">

  <style>
    body {
      font-family: 'PT Sans', sans-serif;
      background: #f8f9fa; /* Light gray background */
      margin: 0;
      padding: 0;
    }
    .main-container {
      /* Make container fluid but restrict to 95% of screen width */
      width: 95%;
      margin: 40px auto; /* Center horizontally with top spacing */
    }
    .heading-title {
      margin-bottom: 30px;
      font-weight: 700;
    }
  </style>
</head>
<body>
  <div class="loader"></div>
  <!-- Navigation (Optional) -->
  <nav class="navbar navbar-dark bg-primary shadow-sm mb-4">
    <div class="container-fluid">
      <span class="navbar-brand mb-0 h1">College Result Portal</span>
    </div>
  </nav>

  <!-- Main Content Container -->
  <div>
    <div class="row justify-content-center">
      <!-- Adjust column widths for better responsiveness on larger screens -->
      <div>
        <h2 class="heading-title text-center">Check Your Result</h2>

        <!-- Card for Form -->
        <div class="card shadow-sm border-0 rounded-3 mb-4">
          <div class="card-body">
            <!-- Roll Number -->
            <div class="mb-3">
              <label for="phoneNumber" class="form-label fw-bold">Roll Number</label>
              <input
                type="number"
                class="form-control"
                id="phoneNumber"
                placeholder="Enter your roll number"
              />
            </div>

            <!-- Class -->
            <div class="mb-3">
              <label for="sheetSelector" class="form-label fw-bold">Class</label>
              <select id="sheetSelector" class="form-select">
                <option value="B-TECH-IT">B-TECH-IT</option>
                <option value="CSE">CSE</option>
                <option value="MECH">MECH</option>
                <option value="ECE">ECE</option>
                <option value="EEE">EEE</option>
              </select>
            </div>

            <!-- Password (previously DOB) -->
    
           <div class="mb-4">
                <label for="password" class="form-label fw-bold">Date of Birth</label>
                <input
                  type="text"
                  class="form-control"
                  id="password"
                  placeholder="MM.DD.YYYY"
                  onfocus="(this.type='date')"
                  onblur="formatDateInput(this)"
                />
            </div>

            <!-- Buttons -->
            <div class="d-flex justify-content-center gap-2">
              <button class="btn btn-success" onclick="getDetail()">Get Result</button>
              <button class="btn btn-primary" onclick="printResult()">Print Result</button>
            </div>
          </div>
        </div>

        <!-- Result Section -->
        <div class="card shadow-sm border-0 rounded-3">
          <div class="card-body" id="result" style="min-height: 100%;"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- Bootstrap Bundle & SweetAlert2 -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

  <script>
    // Replace with your published Web App URL
    const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbwesWpBqD8Za3K5vtj7d6GlrizAj-7_gU095ABZFJHFAGRq06d0cbAm-93cb42v7TUFqw/exec";

    function getDetail() {
      const phoneNumber       = document.getElementById("phoneNumber").value.trim();
      const selectedSheetName = document.getElementById("sheetSelector").value;
      const password          = document.getElementById("password").value.trim(); // Password instead of DOB

      if (!phoneNumber || !selectedSheetName || !password) {
        Swal.fire("Error", "Please fill all required fields.", "error");
        return;
      }

      // Show a loading modal (SweetAlert)
      Swal.fire({
        title: 'Please wait...',
        text: 'We are getting your result',
        allowOutsideClick: false,
        didOpen: () => {
          Swal.showLoading();
        }
      });

      // Construct the query string
      const url = `${WEB_APP_URL}?action=submitDT&phoneNumber=${encodeURIComponent(phoneNumber)}&selectedSheetName=${encodeURIComponent(selectedSheetName)}&password=${encodeURIComponent(password)}`;

      // Fetch the raw HTML from Apps Script
      fetch(url)
        .then(response => response.text())
        .then(htmlString => {
          Swal.close();
          document.getElementById("result").innerHTML = htmlString;
        })
        .catch(err => {
          Swal.close();
          Swal.fire("Error", "Something went wrong: " + err.message, "error");
        });
    }

    // Print only the result section in an A4 format
    function printResult() {
      const printContents   = document.getElementById("result").innerHTML;
      const originalContent = document.body.innerHTML;

      document.body.innerHTML = printContents;
      window.print();
      document.body.innerHTML = originalContent;
    }
  </script>

  <script src="proc.js"></script>
</body>

<script>
    // date script
    function formatDateInput(input) {
      const dateValue = input.value; // Get the selected date in YYYY-MM-DD format
      if (!dateValue) {
        input.type = 'text'; // Revert to text type if no value selected
        return;
      }
    
      // Convert YYYY-MM-DD to MM.DD.YYYY format
      const [year, month, day] = dateValue.split("-");
      const formattedDate = `${month}.${day}.${year}`;
    
      // Replace the input value with the formatted date and reset type
      input.type = 'text';
      input.value = formattedDate;
    }
    
    </script>
</html>
